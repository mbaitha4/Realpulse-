<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#E4405F">
    <title>RealPulse | Authentic News</title>
    <style>
        :root { --primary: #E4405F; --bg: #f0f2f5; --card-bg: #ffffff; --text-main: #1a1a1a; --text-sec: #4b4d50; --nav-height: 165px; }
        [data-theme="dark"] { --bg: #121212; --card-bg: #1e1e1e; --text-main: #e0e0e0; --text-sec: #b0b0b0; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; font-family: 'Segoe UI', system-ui, sans-serif; background: var(--bg); color: var(--text-main); line-height: 1.5; overflow-x: hidden; }
        header { position: fixed; top: 0; width: 100%; background: var(--card-bg); z-index: 1000; box-shadow: 0 2px 12px rgba(0,0,0,0.1); }
        .top-bar { display: flex; justify-content: space-between; align-items: center; padding: 10px 16px; border-bottom: 1px solid rgba(128,128,128,0.1); }
        .logo { font-size: 24px; font-weight: 800; color: var(--primary); letter-spacing: -1px; cursor: pointer; }
        .logo span { color: var(--text-main); }
        .header-controls { display: flex; align-items: center; gap: 8px; }
        .control-btn { background: var(--bg); color: var(--text-main); border: 1px solid rgba(128,128,128,0.2); padding: 6px 12px; border-radius: 15px; font-size: 11px; font-weight: 600; cursor: pointer; }
        .ticker-wrap { background: #000; color: #fff; height: 35px; overflow: hidden; display: flex; align-items: center; }
        .ticker-label { background: var(--primary); padding: 0 15px; height: 100%; display: flex; align-items: center; font-weight: 800; font-size: 11px; z-index: 2; text-transform: uppercase; }
        .ticker-scroll { white-space: nowrap; padding-left: 100%; animation: ticker 40s linear infinite; font-size: 13px; }
        @keyframes ticker { 0% { transform: translate(0, 0); } 100% { transform: translate(-100%, 0); } }
        .category-scroll { display: flex; overflow-x: auto; padding: 10px; gap: 10px; scrollbar-width: none; }
        .cat-pill { padding: 8px 18px; background: var(--bg); border-radius: 20px; font-size: 12px; white-space: nowrap; cursor: pointer; border: none; font-weight: 600; color: var(--text-sec); }
        .cat-pill.active { background: var(--primary); color: #fff; }
        #main-loader { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg); z-index: 9999; display: flex; align-items: center; justify-content: center; }
        .pulse-text { font-size: 36px; font-weight: 900; color: var(--primary); animation: pulseAnim 1.2s infinite ease-in-out; }
        @keyframes pulseAnim { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); opacity: 0.8; } }
        .main-layout { display: flex; justify-content: center; margin-top: var(--nav-height); padding: 15px; padding-bottom: 100px; }
        #news-feed { width: 100%; max-width: 650px; }
        .news-card { background: var(--card-bg); border-radius: 12px; margin-bottom: 24px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .news-img { width: 100%; height: 240px; object-fit: cover; background: #222; }
        .news-info { padding: 15px; }
        .news-title { font-size: 18px; font-weight: 800; color: var(--text-main); text-decoration: none; display: block; margin-bottom: 8px; }
        .news-desc { font-size: 14px; color: var(--text-sec); display: block; margin-bottom: 15px; }
        .card-actions { display: flex; justify-content: space-between; border-top: 1px solid rgba(128,128,128,0.1); padding-top: 12px; }
        .read-more-btn { background: var(--primary); color: #fff; padding: 8px 16px; border-radius: 6px; text-decoration: none; font-size: 12px; font-weight: 700; }
        footer { position: fixed; bottom: 0; width: 100%; background: var(--card-bg); border-top: 1px solid rgba(128,128,128,0.2); display: flex; justify-content: space-around; padding: 10px; z-index: 1000; }
        .footer-btn { display: flex; flex-direction: column; align-items: center; font-size: 10px; color: var(--text-sec); border: none; background: none; cursor: pointer; flex: 1; }
    </style>
</head>
<body data-theme="light">
<div id="main-loader"><div class="pulse-text">RealPulse</div></div>
<header>
    <div class="top-bar">
        <div class="logo" onclick="location.reload()">Real<span>Pulse</span></div>
        <div class="header-controls">
            <button class="control-btn" onclick="toggleDarkMode()">Mode üåô</button>
            <button class="control-btn" onclick="toggleLanguage()" id="langBtn">‡§π‡§ø‡§Ç‡§¶‡•Ä</button>
        </div>
    </div>
    <div class="ticker-wrap"><div class="ticker-label">Breaking</div><div id="breakingTicker" class="ticker-scroll">Loading pulse...</div></div>
    <div class="category-scroll" id="catBar"></div>
</header>
<div class="main-layout"><main id="news-feed"><div id="feed-content"></div></main></div>
<footer>
    <button class="footer-btn" onclick="location.reload()">üè†<br>Home</button>
    <button class="footer-btn">üî•<br>Trending</button>
    <button class="footer-btn">üîñ<br>Save</button>
</footer>

<script>
    let state = { lang: 'en', category: 'general' };

    function init() {
        renderCategories();
        fetchNews();
        if(localStorage.getItem('theme') === 'dark') document.body.setAttribute('data-theme', 'dark');
    }

    function renderCategories() {
        const categories = [
            { id: 'general', en: 'National', hi: '‡§∞‡§æ‡§∑‡•ç‡§ü‡•ç‡§∞‡•Ä‡§Ø' },
            { id: 'nation', en: 'Politics', hi: '‡§∞‡§æ‡§ú‡§®‡•Ä‡§§‡§ø' },
            { id: 'technology', en: 'Tech', hi: '‡§§‡§ï‡§®‡•Ä‡§ï‡•Ä' },
            { id: 'business', en: 'Business', hi: '‡§µ‡•ç‡§Ø‡§æ‡§™‡§æ‡§∞' },
            { id: 'sports', en: 'Sports', hi: '‡§ñ‡•á‡§≤' }
        ];
        document.getElementById('catBar').innerHTML = categories.map(c => `
            <button class="cat-pill ${state.category === c.id ? 'active' : ''}" onclick="setCategory('${c.id}')">
                ${state.lang === 'en' ? c.en : c.hi}
            </button>
        `).join('');
    }

    async function fetchNews() {
        document.getElementById('main-loader').style.display = 'flex';
        // CALLING YOUR HIDDEN API
        const apiUrl = `/api/getnews?category=${state.category}&lang=${state.lang}`;

        try {
            const response = await fetch(apiUrl);
            const data = await response.json();

            if (data.articles) {
                renderArticles(data.articles);
                document.getElementById('breakingTicker').innerText = data.articles.map(a => a.title).join(' ‚Ä¢ ');
            } else {
                throw new Error("No articles found");
            }
        } catch (err) {
            document.getElementById('feed-content').innerHTML = `<div style="text-align:center; padding:50px;">‚ö†Ô∏è API Rate Limit reached. Please check back later.</div>`;
        } finally {
            setTimeout(() => document.getElementById('main-loader').style.display = 'none', 600);
        }
    }

    function renderArticles(articles) {
        document.getElementById('feed-content').innerHTML = articles.map(art => `
            <div class="news-card">
                <img src="${art.image || 'https://picsum.photos/600/300'}" class="news-img">
                <div class="news-info">
                    <div style="font-size:10px; color:var(--primary); font-weight:800;">${art.source.name}</div>
                    <a href="${art.url}" target="_blank" class="news-title">${art.title}</a>
                    <span class="news-desc">${art.description || ''}</span>
                    <div class="card-actions">
                        <a href="${art.url}" target="_blank" class="read-more-btn">Read More</a>
                    </div>
                </div>
            </div>`).join('');
    }

    function setCategory(id) { state.category = id; renderCategories(); fetchNews(); }
    function toggleDarkMode() {
        const isDark = document.body.getAttribute('data-theme') === 'dark';
        document.body.setAttribute('data-theme', isDark ? 'light' : 'dark');
        localStorage.setItem('theme', isDark ? 'light' : 'dark');
    }
    function toggleLanguage() {
        state.lang = state.lang === 'en' ? 'hi' : 'en';
        document.getElementById('langBtn').innerText = state.lang === 'en' ? '‡§π‡§ø‡§Ç‡§¶‡•Ä' : 'English';
        renderCategories(); fetchNews();
    }
    init();
</script>
</body>
</html>
