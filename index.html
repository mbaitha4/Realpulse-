<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Shabadam News - UP & Bihar News</title>

<!-- SEO (UNCHANGED) -->
<meta name="description" content="Shabadam News - Latest Breaking News from Uttar Pradesh & Bihar. Hindi & English News, Politics, Technology, Sports, Business & AI Updates.">
<meta name="keywords" content="UP News, Bihar News, Hindi News, English News, Shabadam News, Uttar Pradesh News, Bihar Samachar, Breaking News India">
<meta name="author" content="Shabadam News">
<meta property="og:title" content="Shabadam News - UP & Bihar News">
<meta property="og:description" content="Latest breaking news from Uttar Pradesh and Bihar in Hindi & English.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://shabadam.com/">
<meta property="og:image" content="https://shabadam.com/logo.png">
<meta name="robots" content="index, follow">
<link rel="canonical" href="https://shabadam.com/">

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#E4405F">

<style>
:root{
--primary:#E4405F;
--bg:#f4f6f9;
--card:#ffffff;
--text:#222;
}
[data-theme="dark"]{
--bg:#121212;
--card:#1e1e1e;
--text:#e0e0e0;
}
body{
margin:0;
font-family:system-ui;
background:var(--bg);
color:var(--text);
}
header{
position:fixed;
top:0;
width:100%;
background:var(--card);
padding:15px;
display:flex;
justify-content:space-between;
align-items:center;
box-shadow:0 3px 15px rgba(0,0,0,.08);
z-index:1000;
}
.logo{
font-weight:900;
font-size:22px;
color:var(--primary);
}
.lang-btn{
padding:6px 14px;
border:none;
border-radius:20px;
background:var(--primary);
color:#fff;
cursor:pointer;
margin-right:15px;
}
.ticker{
margin-top:65px;
background:#000;
color:#fff;
padding:8px;
overflow:hidden;
white-space:nowrap;
}
.ticker span{
display:inline-block;
padding-left:100%;
animation:scroll 25s linear infinite;
}
@keyframes scroll{
0%{transform:translateX(0)}
100%{transform:translateX(-100%)}
}
.cat-bar{
display:flex;
overflow-x:auto;
padding:10px;
gap:8px;
background:var(--card);
}
.cat-btn{
padding:7px 15px;
border:none;
border-radius:20px;
background:#ddd;
cursor:pointer;
font-weight:600;
}
.cat-btn.active{
background:var(--primary);
color:#fff;
}
#feed{
max-width:650px;
margin:auto;
padding:15px;
padding-bottom:120px;
}
.card{
background:var(--card);
border-radius:16px;
overflow:hidden;
margin-bottom:20px;
box-shadow:0 5px 20px rgba(0,0,0,.08);
}
.card img{
width:100%;
height:220px;
object-fit:cover;
}
.info{
padding:15px;
}
.title{
font-weight:700;
font-size:18px;
margin-bottom:8px;
}
.desc{
font-size:14px;
margin-bottom:8px;
}
.date{
font-size:12px;
color:#888;
margin-bottom:10px;
}
.read-btn{
display:inline-block;
padding:8px 15px;
background:var(--primary);
color:#fff;
border-radius:8px;
text-decoration:none;
font-size:13px;
}
.share-btn{
margin-left:10px;
padding:8px 12px;
border:none;
border-radius:8px;
background:#25D366;
color:#fff;
font-size:13px;
cursor:pointer;
}
.modal{
display:none;
position:fixed;
inset:0;
background:rgba(0,0,0,.6);
align-items:center;
justify-content:center;
z-index:2000;
}
.modal-content{
background:#fff;
width:90%;
max-width:500px;
padding:20px;
border-radius:15px;
}
.modal-content input,
.modal-content textarea,
.modal-content select{
width:100%;
margin-bottom:10px;
padding:10px;
border-radius:8px;
border:1px solid #ccc;
}
.modal-content button{
padding:10px;
border:none;
border-radius:8px;
background:var(--primary);
color:#fff;
cursor:pointer;
margin-bottom:6px;
}
</style>
</head>

<body data-theme="light">

<header>
<div class="logo" id="appLogo">Shabadam News</div>
<button class="lang-btn" onclick="toggleLang()">English / ‡§π‡§ø‡§Ç‡§¶‡•Ä</button>
</header>

<div class="ticker">
<span id="breakingNews">Loading breaking news...</span>
</div>

<div class="cat-bar" id="catBar"></div>
<div id="feed"></div>

<footer style="position:fixed;bottom:0;width:100%;background:#fff;display:flex;justify-content:space-around;padding:10px;border-top:1px solid #ddd;">
<button onclick="location.reload()">üè†</button>
<button onclick="openLogin()">‚úçÔ∏è</button>
<button onclick="toggleTheme()">üåô</button>
</footer>

<!-- LOGIN -->
<div class="modal" id="loginModal">
<div class="modal-content">
<h3>Editor Login</h3>
<input id="editorUser" placeholder="Username">
<input id="editorPass" type="password" placeholder="Password">
<button onclick="editorLogin()">Login</button>
<button onclick="closeLogin()">Close</button>
</div>
</div>

<!-- EDITOR -->
<div class="modal" id="editorModal">
<div class="modal-content">
<h3>Post Article</h3>
<input id="titleInput" placeholder="Title">
<textarea id="descInput" rows="5" placeholder="Content"></textarea>
<input type="file" accept="image/*" onchange="handleImageUpload(event)">
<img id="previewImg" style="width:100%;display:none;margin-bottom:10px;border-radius:10px;">
<select id="catInput"></select>
<button onclick="publishArticle()">Publish</button>
<button onclick="closeEditor()">Close</button>
</div>
</div>

<script>
let state={page:1,category:"general",lang:"en",loading:false,finished:false};
let uploadedImage=null;

const EDITOR_USERNAME="editor";
const EDITOR_PASSWORD="Shabadam@2026";

const categories=[
{id:"general",en:"General",hi:"‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø"},
{id:"nation",en:"UP & Bihar",hi:"‡§Ø‡•Ç‡§™‡•Ä & ‡§¨‡§ø‡§π‡§æ‡§∞"},
{id:"business",en:"Business",hi:"‡§µ‡•ç‡§Ø‡§æ‡§™‡§æ‡§∞"},
{id:"technology",en:"Tech/AI",hi:"‡§§‡§ï‡§®‡•Ä‡§ï"},
{id:"sports",en:"Sports",hi:"‡§ñ‡•á‡§≤"},
{id:"miscellaneous",en:"Miscellaneous",hi:"‡§µ‡§ø‡§µ‡§ø‡§ß"}
];

function renderCategories(){
document.getElementById("catBar").innerHTML=
categories.map(c=>`
<button class="cat-btn ${state.category===c.id?"active":""}"
onclick="setCategory('${c.id}')">
${state.lang==="en"?c.en:c.hi}
</button>`).join("");

document.getElementById("catInput").innerHTML=
categories.map(c=>`<option value="${c.id}">${c.en}</option>`).join("");
}

function toggleLang(){
state.lang=state.lang==="en"?"hi":"en";
document.getElementById("appLogo").innerText=
state.lang==="en"?"Shabadam News":"‡§∂‡§¨‡•ç‡§¶‡§Æ‡•ç ‡§®‡•ç‡§Ø‡•Ç‡§ú‡§º";
reset();
renderCategories();
fetchNews();
}

function setCategory(cat){
state.category=cat;
reset();
renderCategories();
fetchNews();
}

function reset(){
state.page=1;
state.finished=false;
document.getElementById("feed").innerHTML="";
}

function timeAgo(date){
if(!date) return "";
const seconds=Math.floor((new Date()-new Date(date))/1000);
let interval=Math.floor(seconds/3600);
if(interval>=1) return interval+" hr ago";
interval=Math.floor(seconds/60);
if(interval>=1) return interval+" min ago";
return "Just now";
}

async function fetchNews(){
if(state.loading||state.finished)return;
state.loading=true;

try{
const res=await fetch(`/api/news?page=${state.page}&category=${state.category}&lang=${state.lang}`);
const data=await res.json();

if(data.articles?.length){
render(data.articles);
state.page++;
}else{
state.finished=true;
}
}catch(e){}

state.loading=false;
}

function render(articles){
articles.forEach(a=>{
feed.innerHTML+=`
<div class="card">
<img src="${a.image||'https://picsum.photos/600/300'}">
<div class="info">
<div class="title">
<a href="${a.url||'#'}" target="_blank" style="text-decoration:none;color:inherit;">
${a.title}
</a>
</div>
<div class="desc">${(a.description||"").split(" ").slice(0,60).join(" ")}...</div>
<div class="date">${timeAgo(a.createdAt||a.publishedAt)}</div>
<a href="${a.url||'#'}" target="_blank" class="read-btn">Read More</a>
<button class="share-btn" onclick="shareNews('${a.title}','${a.url||location.href}')">Share</button>
</div>
</div>`;
});
}

window.addEventListener("scroll",()=>{
if(window.innerHeight + window.scrollY >= document.documentElement.scrollHeight - 150){
fetchNews();
}
});

function shareNews(title,url){
if(navigator.share){
navigator.share({title,url});
}else{
window.open(`https://wa.me/?text=${encodeURIComponent(title+" "+url)}`,'_blank');
}
}

function toggleTheme(){
document.body.setAttribute("data-theme",
document.body.getAttribute("data-theme")==="dark"?"light":"dark");
}

function openLogin(){loginModal.style.display="flex";}
function closeLogin(){loginModal.style.display="none";}
function openEditor(){editorModal.style.display="flex";}
function closeEditor(){editorModal.style.display="none";}

function editorLogin(){
if(editorUser.value===EDITOR_USERNAME && editorPass.value===EDITOR_PASSWORD){
closeLogin();openEditor();
}else alert("Invalid credentials");
}

function handleImageUpload(event){
const file=event.target.files[0];
const reader=new FileReader();
reader.onload=e=>{
uploadedImage=e.target.result;
previewImg.src=uploadedImage;
previewImg.style.display="block";
};
reader.readAsDataURL(file);
}

async function publishArticle(){
if(!uploadedImage){alert("Upload image");return;}
await fetch("/api/editor-post",{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({
title:titleInput.value,
description:descInput.value,
image:uploadedImage,
category:catInput.value,
lang:state.lang
})
});
alert("Published");
closeEditor();
reset();
fetchNews();
}

renderCategories();
fetchNews();
</script>

</body>
</html>
